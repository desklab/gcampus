{% extends "gcampuscore/base.html" %}
{% load i18n static icon %}
{% block title %}
    {% translate "Add Data Points" %}
{% endblock %}
{% block body_class %}bg-light{% endblock %}
{% block content %}
    <div class="container pb-3">
        <div class="py-5 text-center">
            <h2>{% translate "Add Data Points" %}</h2>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <form method="POST">
                    <div class="invalid-feedback">
                        {% for error in formset.non_form_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                    {% csrf_token %}
                    {{ formset.management_form }}
                    <ol class="list-group list-group-numbered">
                        {% for form in formset %}
                            {% include "gcampuscore/forms/components/datapoint_form.html" with form=form show=True only %}
                        {% endfor %}
                        <div class="list-group-item text-center">
                            <button type="button" id="id_{{ formset.prefix }}-ADD"
                                    class="btn btn-primary btn-sm w-50">
                                {% icon "plus" height="16" width="16" style="vertical-align: text-bottom" %}
                                {% translate "Add" %}
                            </button>
                        </div>
                    </ol>
                    <div class="mt-3 w-100 align-items-end d-flex">
                        <a href="." class="ms-auto btn btn-secondary btn-block">
                            {% icon "x" height="16" width="16" style="vertical-align: text-bottom" %}
                            {% translate "Discard" %}
                        </a>
                        <button type="submit" class="ms-2 btn btn-primary btn-block">
                            {% icon "check" height="16" width="16" style="vertical-align: text-bottom" %}
                            {% translate "Save" %}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <template id="id_{{ formset.prefix }}-EMPTY_FORM_TEMPLATE">
        {% include "gcampuscore/forms/components/datapoint_form.html" with form=formset.empty_form show=False only %}
    </template>
{% endblock %}
{% block extra_body %}
    <script type="text/javascript" src="{% static 'gcampuscore/js/dynamicformset.js' %}"></script>
    <script type="text/javascript">
        window.addEventListener('load', () => {
            let formset = new gcampus.DynamicFormset("{{ formset.prefix }}");
        });
    </script>
{% endblock %}
